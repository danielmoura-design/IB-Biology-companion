<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IB Biology Companion</title>
    
    <!-- Global Error Handler -->
    <script>
      window.onerror = function(msg, url, line, col, error) {
        // Ignore harmless ResizeObserver errors
        if (msg.includes("ResizeObserver loop")) return false;
        
        var errorHtml = `
          <div style="position:fixed; top:0; left:0; width:100%; z-index:9999; background:#fee2e2; color:#991b1b; padding:20px; border-bottom:1px solid #f87171; font-family:sans-serif;">
            <h3 style="margin-top:0;">Application Error</h3>
            <p><strong>Message:</strong> ${msg}</p>
            <p><strong>Line:</strong> ${line}</p>
            <p><em>Please refresh the page. If the error persists, check the console.</em></p>
          </div>
        `;
        document.body.insertAdjacentHTML('afterbegin', errorHtml);
        return false;
      };
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#0f766e', // Teal-700
              secondary: '#f0fdfa', // Teal-50
              accent: '#d97706', // Amber-600
            }
          }
        }
      }
    </script>

    <!-- React 18 & Router (UMD Globals) - Version 6.3.0 is chosen for UMD stability -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/history@5.3.0/umd/history.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-router@6.3.0/umd/react-router.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-router-dom@6.3.0/umd/react-router-dom.production.min.js"></script>

    <!-- Babel for in-browser JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      /* Custom scrollbar for better aesthetics */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #f1f5f9; 
      }
      ::-webkit-scrollbar-thumb {
        background: #cbd5e1; 
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #94a3b8; 
      }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.1",
    "react-dom/": "https://esm.sh/react-dom@^19.2.1/",
    "react/": "https://esm.sh/react@^19.2.1/",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.10.1",
    "lucide-react": "https://esm.sh/lucide-react@^0.560.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body class="bg-slate-50 text-slate-900 antialiased overflow-hidden">
    <div id="root"></div>

    <!-- Application Code -->
    <script type="text/babel">
      // 1. Destructure Globals
      const { useState, useEffect, useMemo } = React;
      // Ensure ReactRouterDOM is available
      const { HashRouter, Routes, Route, Navigate, useLocation, NavLink } = window.ReactRouterDOM;
      const ReactDOM = window.ReactDOM;

      // 2. Icon Components (Inlined to prevent loading errors)
      const Icons = {
        Home: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
        Activity: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>,
        Calendar: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg>,
        FileText: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></svg>,
        CheckSquare: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>,
        BookOpen: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>,
        Layers: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>,
        Bell: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg>,
        Menu: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>,
        ChevronLeft: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
        ChevronRight: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m9 18 6-6-6-6"/></svg>,
        ChevronDown: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m6 9 6 6 6-6"/></svg>,
        ExternalLink: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" x2="21" y1="14" y2="3"/></svg>,
        Folder: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 2H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z"/></svg>,
        Download: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>,
        Check: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
      };

      // ==========================================
      // CONSTANTS & TYPES (Runtime)
      // ==========================================
      
      const PageRoute = {
        HOME: '/',
        TRACKER: '/tracker',
        CALENDAR: '/calendar',
        INTERNAL_ASSESSMENT: '/internal-assessment',
        EXERCISES: '/exercises',
        KOGNITY: '/kognity',
        SYLLABUS: '/syllabus',
      };

      const CALENDAR_EVENTS = [
        // --- 2025 SCHEDULE ---
        { id: 'mock-1', title: 'Mock Exams Start', startDate: '2025-04-10', type: 'exam' },
        { id: 'quiz-1', title: 'Theme A Review Quiz', startDate: '2025-02-28', type: 'reminder' },
        { id: 'ec-2025-1', title: 'Submit Project Planner (RQ, Hypothesis, Methodology)', startDate: '2025-03-31', endDate: '2025-04-05', type: 'deadline' },
        { id: 'ec-2025-2', title: 'Feedback on the Project Planner', startDate: '2025-04-28', endDate: '2025-05-02', type: 'reminder' },
        { id: 'ec-2025-3', title: 'Submit revised Project Planner', startDate: '2025-05-12', endDate: '2025-05-16', type: 'deadline' },
        { id: 'ec-2025-4', title: 'Start experiments/data collection', startDate: '2025-06-02', endDate: '2025-06-06', type: 'reminder' },
        { id: 'ec-2025-5', title: 'Raw data submission', startDate: '2025-08-04', endDate: '2025-08-08', type: 'deadline' },
        { id: 'ec-2025-6', title: 'Share processed data and analysis', startDate: '2025-09-01', endDate: '2025-09-05', type: 'deadline' },
        { id: 'ec-2025-7', title: 'Students hand in the first draft', startDate: '2025-10-27', endDate: '2025-10-31', type: 'deadline' },
        { id: 'ec-2025-8', title: 'Teacher\'s feedback on the first draft', startDate: '2025-11-10', endDate: '2025-11-14', type: 'reminder' },
        { id: 'ec-2025-9', title: 'Students hand in the final version', startDate: '2025-12-01', endDate: '2025-12-05', type: 'deadline' },
        // --- 2026 SCHEDULE ---
        { 
          id: 'ec-2026-1', 
          title: 'Research question + Detailed outline', 
          startDate: '2026-02-09', 
          endDate: '2026-02-27',
          type: 'deadline',
          description: 'After conducting discussions in class and individual research on possible topics, background information and methodologies, students will complete an outline form and submit a research question.'
        },
        { 
          id: 'ec-2026-2', 
          title: 'Methodology + List of materials', 
          startDate: '2026-03-16', 
          endDate: '2026-04-03',
          type: 'deadline',
          description: 'After receiving feedback and submitting a final version of the RQ, students will write their methodology alongside their list of materials.'
        },
        { 
          id: 'ec-2026-3', 
          title: 'Submit raw/processed data (data based IA)', 
          startDate: '2026-05-04', 
          endDate: '2026-05-15',
          type: 'deadline',
          description: 'Students will deliver their raw/processed data tables, according to the timeline of scheduled experiments.'
        },
        { 
          id: 'ec-2026-4', 
          title: 'Submit raw/processed data (experiment based IA)', 
          startDate: '2026-06-08', 
          endDate: '2026-06-19',
          type: 'deadline',
          description: 'Students will deliver their raw/processed data tables, according to the timeline of scheduled experiments.'
        },
        { 
          id: 'ec-2026-5', 
          title: 'Submit first draft', 
          startDate: '2026-08-03', 
          endDate: '2026-08-14',
          type: 'deadline',
          description: 'Students will work in the analysis of the data gathered and conclusion, leading to the first complete draft of the production. During this process the teacher will be observing the student and will be helping them understand any problems they might have.'
        },
        { 
          id: 'ec-2026-6', 
          title: 'Students receive feedback on first draft', 
          startDate: '2026-09-21', 
          endDate: '2026-10-02',
          type: 'deadline',
          description: 'Students receive feedback on first draft'
        },
        { 
          id: 'ec-2026-7', 
          title: 'Students submit final draft', 
          startDate: '2026-11-16', 
          endDate: '2026-11-20',
          type: 'deadline',
          description: 'Students submit the final draft of their work.'
        }
      ];

      const EXERCISES = [
        { id: 'A1.2', title: 'A1.2 - Nucleic acids', pdfLink: 'https://drive.google.com/file/d/17ZV8Tc5WcOYRTmFFzfmJ-R-gs17XMS1d/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1P6xFRi1zQhnsRWZS7GXgO5m19aMOdRLG/view?usp=drive_link' },
        { id: 'A2.2', title: 'A2.2 - Cell structure', pdfLink: 'https://drive.google.com/file/d/1b0jr2XCA9v9qef_9_aC7hPAcZrR76DaN/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1ks-AK_QrIRv6EeGOezfnascGbtlI_1lR/view?usp=drive_link' },
        { id: 'A3.2', title: 'A3.2 - Classification and cladistics', pdfLink: 'https://drive.google.com/file/d/18fJ3BjLUCxQykqaA-Y4HSS4Wdjt9Zngc/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1ZLTaqslVyd8fi4XYwfDcu0YSsQ-ICt-T/view?usp=drive_link' },
        { id: 'A4.1', title: 'A4.1 - Evolution and speciation', pdfLink: 'https://drive.google.com/file/d/1dzLHGkVER2sgu78ZTq3B0vSUSy6yzIX5/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1KdCWp_I-RqLJRRziyOvmfHM9ORxTRIBN/view?usp=drive_link' },
        { id: 'B1.2', title: 'B1.2 - Proteins', pdfLink: 'https://drive.google.com/file/d/1xvR_Uw1YVcpz9S5_mEjG6vTS0M5ecuw5/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1l3A1GHXVuy2SYdZoAUrJ4oveHKv0MU2R/view?usp=drive_link' },
        { id: 'B4.1', title: 'B4.1 - Adaptation to environment', pdfLink: 'https://drive.google.com/file/d/1m5kLhvqwGF5q5YQXchOQlBdJbqREiPy3/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1g3WJdGGRlNxRRbdx16jG_nRa9EO7HjnV/view?usp=drive_link' },
        { id: 'B4.2', title: 'B4.2 - Ecological niches', pdfLink: 'https://drive.google.com/file/d/1IhXJ6FSj7cxkFhSWl667uydktEF58fck/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1D2LQh1IwV-vG0YGPnkYVqsKXNKwTKBDd/view?usp=drive_link' },
        { id: 'C4.1', title: 'C4.1 - Populations and Communities', pdfLink: 'https://drive.google.com/file/d/1P6xFRi1zQhnsRWZS7GXgO5m19aMOdRLG/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1IhGUcVdTAUW2g-R6x2pwGQ-OetVBO8sN/view?usp=drive_link' },
        { id: 'D3.2', title: 'D3.2 - Inheritance', pdfLink: 'https://drive.google.com/file/d/1kw4Q4yC58Le62hTPPyVHBDIVMRvxAio9/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1ZdyzhCbaofyoak3X8BxNJtUqun5wLqSL/view?usp=drive_link' },
        { id: 'D4.1', title: 'D4.1 - Natural selection', pdfLink: 'https://drive.google.com/file/d/1i4g1bDjH_32PleyLseVXcNZD55fBACtv/view?usp=drive_link', markschemeLink: 'https://drive.google.com/file/d/1L_muPcvfFPZTL1LyaOG_p_whsuFAAMlV/view?usp=drive_link' },
        { id: 'D1.2', title: 'D1.2 - Protein Synthesis', pdfLink: 'https://drive.google.com/file/d/1zH8xCvyFeEPdtn5H0lszEi1v0Vp5luJI/view?usp=sharing', markschemeLink: 'https://drive.google.com/file/d/1mPnjSSXa1MjWaGk36CIM72GhwBxy-mDm/view?usp=sharing' },
        { id: 'D2.1', title: 'D2.1 - Cell and Nuclear Division', pdfLink: 'https://drive.google.com/file/d/17bHg3YZE--GZJpaRdPIW_4hJn2S_yigT/view?usp=sharing', markschemeLink: 'https://drive.google.com/file/d/1mzZ6FyHX5H-anYF2KaTiWSdTWhoIO4VM/view?usp=sharing' },
        { id: 'D1.1', title: 'D1.1 - DNA Replication', pdfLink: 'https://drive.google.com/file/d/1MQXbIY3bVWpx5KQJ0tgNyUebYFDwPm5H/view?usp=sharing', markschemeLink: 'https://drive.google.com/file/d/1KMij_1Ic55vpe87DCCgnimyn-4MVW8Zf/view?usp=sharing' },
        { id: 'D1.3', title: 'D1.3 - Mutations and gene editing', pdfLink: 'https://drive.google.com/file/d/1-pPT-zA980_7IbCUH9P4F_m8XlniKNMK/view?usp=sharing', markschemeLink: 'https://drive.google.com/file/d/1REal9KaszJVOQQ4Q7ytreu6N_y6bVD-z/view?usp=sharing' }
      ];

      const IA_RESOURCES = [
        { title: 'Internal Assessment Criteria', description: 'Detailed rubric and marking criteria for the IA.', link: 'https://drive.google.com/file/d/1Q9__EfAF1vqdn88SFfsftyYrFAt_MnIu/view?usp=drive_link', type: 'pdf' },
        { title: 'Experiment Guidelines', description: 'Safety rules and structural guidelines for your experiment.', link: 'https://drive.google.com/file/d/1L8WFS_t1M1k8rCwFkq8PMcvuiwvtcRxP/view?usp=drive_link', type: 'pdf' },
        { title: 'Overall Structure Sample', description: 'An example of how to structure your final paper.', link: 'https://drive.google.com/file/d/1SAckSQJvA_ujPlA9_GeLy1jvZdqXCV7q/view?usp=drive_link', type: 'pdf' },
        { title: 'APA 7th Edition Guide', description: 'Quick reference guide for citations and references.', link: 'https://drive.google.com/file/d/1i7dLelCcjbmWCGdidyo62zlfH7jPGF1f/view?usp=drive_link', type: 'pdf' },
        { title: 'Samples', description: 'A collection of IA samples and materials to guide your work.', link: 'https://drive.google.com/drive/folders/1PtM_92Sq8DYXqn_cKm7zyI-BU1VKHuNe?usp=sharing', type: 'folder' }
      ];

      const SYLLABUS_DATA = [
        {
          id: 'A', name: 'Theme A', title: 'Unity and Diversity', description: 'Theme A focuses on the common origins and unifying characteristics of life on Earth, from the molecular structure of water and nucleic acids to the cellular basis of life and the diversity of organisms evolved through natural selection.', link: 'https://drive.google.com/file/d/1Jy1VvL97fsA95tYlHm04XULpLQ_vEj1J/view?usp=drive_link',
          items: [
            { id: 'A1.1', title: 'A1.1: Water', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Medium of Life:</strong> Water is the medium in which all life originated and evolved.</li><li><strong>Hydrogen Bonding:</strong> Polarity of water molecules leads to hydrogen bonds between them.</li><li><strong>Cohesion & Adhesion:</strong> Explains transport in plants (xylem) and surface tension.</li><li><strong>Solvent Properties:</strong> Dissolves polar/ionic substances, facilitating metabolic reactions and transport.</li><li><strong>Physical Properties:</strong> Buoyancy, viscosity, thermal conductivity, and high specific heat capacity compared to air.</li></ul>' },
            { id: 'A1.2', title: 'A1.2: Nucleic Acids', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Genetic Material:</strong> DNA and RNA are polymers of nucleotides acting as the genetic material.</li><li><strong>Nucleotide Structure:</strong> Pentose sugar, phosphate group, and nitrogenous base.</li><li><strong>DNA vs RNA:</strong> Differences in sugar (deoxyribose vs ribose) and bases (Thymine vs Uracil).</li><li><strong>Double Helix:</strong> DNA strands are antiparallel, held by hydrogen bonds between complementary bases (A-T, G-C).</li><li><strong>Conservation:</strong> The genetic code is universal, supporting the theory of common ancestry.</li></ul>' },
            { id: 'A2.1', title: 'A2.1: Origins of Cells', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Early Earth:</strong> Conditions favored the synthesis of simple organic compounds.</li><li><strong>LUCA:</strong> Last Universal Common Ancestor; evidence includes universal genetic code and shared molecular machinery.</li><li><strong>RNA World:</strong> Hypothesis that RNA was the first genetic material (catalytic and self-replicating).</li><li><strong>Endosymbiosis:</strong> Mitochondria and chloroplasts evolved from free-living prokaryotes engulfed by ancestral cells.</li></ul>' },
            { id: 'A2.2', title: 'A2.2: Cell Structure', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Cell Theory:</strong> All living things are composed of cells; cells come from pre-existing cells.</li><li><strong>Microscopy:</strong> Light vs. Electron microscopy (resolution and magnification).</li><li><strong>Prokaryotes:</strong> Lack a nucleus/compartmentalization (Nucleoid, 70S ribosomes, cell wall, pili).</li><li><strong>Eukaryotes:</strong> Compartmentalized structure. Organelles include Nucleus, RER, Golgi, Lysosome, Mitochondrion, Chloroplast, Vacuoles, and Cytoskeleton.</li><li><strong>Membranes:</strong> Fluid mosaic model, phospholipid bilayer, integral/peripheral proteins, and cholesterol.</li></ul>' },
            { id: 'A2.3', title: 'A2.3: Viruses', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Nature:</strong> Non-living entities lacking metabolism and self-reproduction.</li><li><strong>Structure:</strong> Capsid (protein coat) and genetic material (DNA or RNA).</li><li><strong>Bacteriophages:</strong> Viruses that infect bacteria.</li><li><strong>Life Cycles:</strong> Lytic (rapid destruction) vs. Lysogenic (integration into host genome) cycles.</li><li><strong>Evolution:</strong> Rapid evolution (e.g., Influenza, HIV) due to high mutation rates.</li></ul>' },
            { id: 'A3.1', title: 'A3.1: Diversity of Organisms', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Variation:</strong> Differences exist between individuals and species.</li><li><strong>Species Concept:</strong> Biological species concept (interbreeding populations). Limitations exist (asexual, hybrids).</li><li><strong>Karyotypes:</strong> Number and appearance of chromosomes; used to identify species and sex.</li><li><strong>Genomes:</strong> Total genetic information. Sizes vary significantly between organisms.</li></ul>' },
            { id: 'A3.2', title: 'A3.2: Classification and Cladistics', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Taxonomy:</strong> Hierarchy of taxa (Domain, Kingdom, Phylum, Class, Order, Family, Genus, Species).</li><li><strong>Binomial Nomenclature:</strong> Scientific naming system (<i>Genus species</i>).</li><li><strong>Three Domains:</strong> Archaea, Bacteria, Eukarya (based on rRNA sequences).</li><li><strong>Cladistics:</strong> Classification based on common ancestry. Clades include an ancestor and all descendants.</li><li><strong>Molecular Clocks:</strong> Using mutation rates to estimate divergence times.</li></ul>' },
            { id: 'A4.1', title: 'A4.1: Evolution and Speciation', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Evolution:</strong> Change in allele frequencies in a population over time.</li><li><strong>Evidence:</strong> Fossil record, homologous structures (pentadactyl limb), selective breeding.</li><li><strong>Natural Selection:</strong> Variation, Overproduction, Selection Pressure, Differential Survival/Reproduction.</li><li><strong>Speciation:</strong> Formation of new species via reproductive isolation (Allopatric/Geographic vs. Sympatric).</li><li><strong>Barriers:</strong> Temporal, Behavioral, and Geographic isolation.</li></ul>' },
            { id: 'A4.2', title: 'A4.2: Conservation of Biodiversity', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Biodiversity:</strong> Richness and evenness of life (genetic, species, ecosystem).</li><li><strong>Crisis:</strong> Current 6th mass extinction caused by human activity (habitat loss, invasive species, climate change).</li><li><strong>Conservation:</strong> In situ (reserves, rewilding) vs. Ex situ (zoos, seed banks, botanic gardens).</li><li><strong>EDGE Species:</strong> Evolutionarily Distinct and Globally Endangered species prioritization.</li></ul>' },
            { id: 'A-NOS', title: 'Nature of Science (NOS) - Theme A', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Falsification of Theories:</strong> Evidence from Pasteur\'s experiments falsified the theory of spontaneous generation (A2.1).</li><li><strong>Use of Models:</strong> Crick and Watson used model making to discover the structure of DNA (A1.2).</li><li><strong>Collaboration:</strong> The Human Genome Project demonstrated international collaboration to sequence the entire human genome (A3.1).</li><li><strong>Paradigm Shifts:</strong> Cladistics has caused a shift in classification, moving away from purely morphological characteristics to molecular evidence (A3.2).</li><li><strong>Improvements in Apparatus:</strong> The invention of the electron microscope led to a greater understanding of cellular ultrastructure (A2.2).</li><li><strong>Theories:</strong> The Cell Theory explains that all living things are composed of cells (A2.2).</li><li><strong>Uncertainty:</strong> The definition of a species can be blurred (e.g. ring species, hybrids), showing the limitations of the biological species concept (A3.1).</li></ul>' },
            { id: 'A-Skills', title: 'Approaches to Learning (Skills) - Theme A', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Microscopy:</strong> Use of a light microscope to investigate the structure of cells and tissues, including drawing cells and calculating magnification (A2.2).</li><li><strong>Data Analysis:</strong> Analysis of electron micrographs to identify organelles and deduce the function of specialized cells (A2.2).</li><li><strong>Database Use:</strong> Use of molecular databases (e.g., BLAST) to compare DNA or protein sequences for cladistics (A3.2).</li><li><strong>Cladograms:</strong> Construction and analysis of cladograms to deduce evolutionary relationships (A3.2).</li><li><strong>Dichotomous Keys:</strong> Construction and use of dichotomous keys for identification of species (A3.2).</li><li><strong>Correlation vs Causation:</strong> Analyzing data regarding speciation and environmental factors (A4.1).</li></ul>' }
          ]
        },
        {
          id: 'B', name: 'Theme B', title: 'Form and Function', description: 'Theme B explores how the structure of biological molecules, cells, and organisms facilitates their specific functions. It covers the organization of life from the molecular level (carbohydrates, lipids, proteins) to the cellular level (membranes, organelles) and organismal level (physiological systems).', link: 'https://drive.google.com/file/d/1OMO8njT2khWduF8Ag1tWof-HMDi1ztMM/view?usp=drive_link',
          items: [
            { id: 'B1.1', title: 'B1.1: Carbohydrates and Lipids', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Chemical Basics:</strong> Carbon compounds; condensation reactions form polymers, hydrolysis breaks them down.</li><li><strong>Carbohydrates:</strong> Monosaccharides (glucose, ribose), disaccharides (sucrose), and polysaccharides.</li><li><strong>Polysaccharides:</strong> Cellulose (structure in plants), Starch (storage in plants), Glycogen (storage in animals).</li><li><strong>Lipids:</strong> Triglycerides (energy storage, insulation), phospholipids (membranes), steroids. Hydrophobic properties.</li><li><strong>Energy Storage:</strong> Lipids provide long-term energy storage (more energy per gram) compared to carbohydrates (short-term).</li></ul>' },
            { id: 'B1.2', title: 'B1.2: Proteins', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Amino Acids:</strong> 20 different amino acids; R-groups determine chemical properties.</li><li><strong>Peptide Bonds:</strong> Formed between amino acids via condensation.</li><li><strong>Structure Levels:</strong> Primary (sequence), Secondary (alpha-helix, beta-sheet), Tertiary (3D folding), Quaternary (multiple polypeptides).</li><li><strong>Functionality:</strong> Globular proteins (enzymes, hemoglobin) are soluble; Fibrous proteins (collagen, spider silk) are structural.</li><li><strong>Denaturation:</strong> Loss of structure and function due to extreme pH or temperature.</li></ul>' },
            { id: 'B2.1', title: 'B2.1: Membranes and Transport', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Fluid Mosaic Model:</strong> Phospholipid bilayer with integral and peripheral proteins. Amphipathic nature.</li><li><strong>Cholesterol:</strong> Regulates membrane fluidity in animal cells.</li><li><strong>Passive Transport:</strong> Simple diffusion, facilitated diffusion (channels/carriers), osmosis (water movement).</li><li><strong>Active Transport:</strong> Requires ATP (e.g., Sodium-Potassium pump).</li><li><strong>Vesicle Transport:</strong> Endocytosis (entry) and Exocytosis (exit) dependent on membrane fluidity.</li></ul>' },
            { id: 'B2.2', title: 'B2.2: Organelles and Compartmentalization', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Compartmentalization:</strong> Eukaryotic cells use membranes to isolate metabolic processes (e.g., enzymes in lysosomes).</li><li><strong>Nucleus:</strong> Separates transcription (DNA to mRNA) from translation (cytoplasm).</li><li><strong>Mitochondria:</strong> Double membrane creates intermembrane space for proton gradients (Chemiosmosis).</li><li><strong>Chloroplasts:</strong> Thylakoids and stroma for photosynthesis.</li><li><strong>Ribosomes:</strong> Free (intracellular proteins) vs. Bound to RER (secretion/lysosomes).</li></ul>' },
            { id: 'B2.3', title: 'B2.3: Cell Specialization', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Differentiation:</strong> Cells become specialized by expressing only specific genes from the genome.</li><li><strong>Stem Cells:</strong> Totipotent, pluripotent, and multipotent cells with capacity to divide and differentiate. Therapeutic uses (e.g., Stargardt\'s disease).</li><li><strong>SA:Vol Ratio:</strong> Limits cell size; larger cells have less surface area relative to volume for exchange.</li><li><strong>Multicellularity:</strong> Emergent properties arise from the interaction of cellular components.</li></ul>' },
            { id: 'B3.1', title: 'B3.1: Gas Exchange', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Surfaces:</strong> Requirements include large surface area, permeability, thin membranes, and moisture (e.g., Alveoli).</li><li><strong>Ventilation:</strong> Maintains concentration gradients. Antagonistic muscle action (diaphragm/intercostals).</li><li><strong>Pneumocytes:</strong> Type I (exchange) and Type II (surfactant secretion).</li><li><strong>Plants:</strong> Stomata and spongy mesophyll facilitate gas exchange.</li><li><strong>Hemoglobin:</strong> Oxygen transport; cooperative binding and affinity changes (Bohr shift - HL).</li></ul>' },
            { id: 'B3.2', title: 'B3.2: Transport', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Plants:</strong> Transpiration (loss of water vapor) generates tension (cohesion-tension theory) in xylem.</li><li><strong>Phloem:</strong> Active translocation of organic compounds (source to sink) via hydrostatic pressure gradients.</li><li><strong>Circulatory Systems:</strong> Double circulation in mammals separates oxygenated/deoxygenated blood.</li><li><strong>Vessels:</strong> Arteries (high pressure, thick walls), Veins (valves, low pressure), Capillaries (exchange).</li><li><strong>Heart:</strong> Myogenic contraction, pacemaker (SA node), cardiac cycle.</li></ul>' },
            { id: 'B3.3', title: 'B3.3: Muscle and Motility', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Skeletal Muscle:</strong> Striated, multinucleated fibers containing myofibrils.</li><li><strong>Sarcomere:</strong> Functional unit; arrangement of actin (thin) and myosin (thick) filaments.</li><li><strong>Sliding Filament Theory:</strong> Myosin heads form cross-bridges with actin, pulling filaments to shorten sarcomere.</li><li><strong>Control:</strong> Calcium ions bind troponin, moving tropomyosin to expose binding sites. ATP hydrolysis powers movement.</li></ul>' },
            { id: 'B4.1', title: 'B4.1: Adaptation to Environment', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Adaptations:</strong> Heritable traits (structural, behavioral, physiological) developed through natural selection.</li><li><strong>Biomes:</strong> Distribution determined by climatic variables (temperature and precipitation). Examples: Taiga, Desert, Tundra, Rainforest.</li><li><strong>Convergent Evolution:</strong> Unrelated species evolve similar traits due to similar environmental pressures (e.g., wings in birds/bats/insects).</li><li><strong>Coral Reefs:</strong> Sensitivity to environmental changes (temperature, acidity).</li></ul>' },
            { id: 'B4.2', title: 'B4.2: Ecological Niches', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Niche:</strong> The unique role of a species in its ecosystem (habitat, nutrition, interactions).</li><li><strong>Types:</strong> Fundamental (potential) vs. Realized (actual) niche.</li><li><strong>Competitive Exclusion:</strong> Two species cannot occupy the exact same niche indefinitely; one will outcompete the other.</li><li><strong>Specialization:</strong> Avoids competition (resource partitioning).</li></ul>' },
            { id: 'B-NOS', title: 'Nature of Science (NOS) - Theme B', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Falsification of Theories:</strong> Evidence from freeze-fracture electron microscopy falsified the Davson-Danielli \'sandwich\' model of the membrane, leading to the Singer-Nicolson fluid mosaic model (B2.1).</li><li><strong>Use of Models:</strong> Physical models were used to determine the structure of DNA and are used to visualize protein folding (B1.2).</li><li><strong>Developments in Research:</strong> Radioisotopes (autoradiography) were used to demonstrate the bidirectional replication of DNA (B1.2 - related).</li><li><strong>Accidental Discovery:</strong> The synthesis of urea by Friedrich WÃ¶hler falsified vitalism (B1.1).</li><li><strong>Theories:</strong> The Sliding Filament theory explains muscle contraction based on experimental evidence (B3.3).</li></ul>' },
            { id: 'B-Skills', title: 'Approaches to Learning (Skills) - Theme B', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Experimental Design:</strong> Investigation of factors affecting enzyme activity (temperature, pH, substrate concentration) (B1.2).</li><li><strong>Microscopy:</strong> Drawing and interpreting electron micrographs of membrane structures and organelles (B2.1, B2.2).</li><li><strong>Estimation:</strong> Estimation of osmolarity in tissues by bathing samples in hypotonic and hypertonic solutions (B2.1).</li><li><strong>Chromatography:</strong> Separation of photosynthetic pigments by paper or thin-layer chromatography (B2.2).</li><li><strong>Measurement:</strong> Measurement of transpiration rates using potometers (B3.2).</li><li><strong>Data Analysis:</strong> Analyzing epidemiological data relating to coronary heart disease (B3.2).</li><li><strong>BMI Calculation:</strong> Determination of Body Mass Index using nomograms or formulas (B1.1).</li></ul>' }
          ]
        },
        {
          id: 'C', name: 'Theme C', title: 'Interaction and Interdependence', description: 'Theme C emphasizes the systems approach to biology, focusing on the interactions between biological systems and their interdependence. This includes molecular interactions (enzymes), cellular energy transformations (respiration, photosynthesis), signalling systems, body systems, and ecosystem dynamics.', link: 'https://drive.google.com/file/d/1tzkMG6VVpAcK6XyN32MwiqM-Q8TadUcA/view?usp=drive_link',
          items: [
            { id: 'C1.1', title: 'C1.1: Enzymes', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Biological Catalysts:</strong> Globular proteins that speed up reactions by lowering activation energy.</li><li><strong>Active Site:</strong> Specific region where substrate binds (Lock and Key vs Induced Fit models).</li><li><strong>Factors Affecting Rate:</strong> Temperature (optimum, then denaturation), pH (optimum, then denaturation), Substrate Concentration (saturation point).</li><li><strong>Immobilized Enzymes:</strong> Enzymes attached to a surface (e.g., alginate beads) for industrial use (e.g., production of lactose-free milk).</li></ul>' },
            { id: 'C1.2', title: 'C1.2: Cell Respiration', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>ATP:</strong> Adenosine Triphosphate, the universal energy currency of cells. High energy bonds.</li><li><strong>Anaerobic Respiration:</strong> Occurs in cytoplasm without oxygen. Small ATP yield. Produces lactate in humans; ethanol and CO2 in yeast.</li><li><strong>Aerobic Respiration:</strong> Occurs in mitochondria with oxygen. Large ATP yield. Pyruvate is broken down into CO2 and H2O.</li><li><strong>Respirometers:</strong> Apparatus used to measure the rate of respiration by measuring oxygen consumption.</li></ul>' },
            { id: 'C1.3', title: 'C1.3: Photosynthesis', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Energy Conversion:</strong> Light energy converted into chemical energy (carbon compounds).</li><li><strong>Pigments:</strong> Chlorophyll absorbs red and blue light, reflects green light. Action vs Absorption spectra.</li><li><strong>Photolysis:</strong> Splitting of water molecules using light energy to produce oxygen, protons, and electrons.</li><li><strong>Limiting Factors:</strong> Temperature, Light Intensity, and CO2 Concentration affect the rate of photosynthesis.</li><li><strong>Chromatography:</strong> Technique to separate and identify photosynthetic pigments based on Rf values.</li></ul>' },
            { id: 'C2.1', title: 'C2.1: Chemical Signalling', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Communication:</strong> Cells detect and respond to changes via chemical signals (ligands) binding to receptors.</li><li><strong>Hormones:</strong> Chemical messengers transported by blood. Examples: Insulin/Glucagon (blood glucose), Thyroxin (metabolic rate), Leptin (appetite), Melatonin (circadian rhythms).</li><li><strong>Mechanism:</strong> Steroid hormones cross membranes (bind intracellularly); Peptide hormones bind to surface receptors (secondary messengers).</li></ul>' },
            { id: 'C2.2', title: 'C2.2: Neural Signalling', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Neurons:</strong> Transmit electrical impulses. Structure: Dendrites, cell body, axon, myelin sheath (saltatory conduction).</li><li><strong>Resting Potential:</strong> Maintained by sodium-potassium pumps (approx -70mV).</li><li><strong>Action Potential:</strong> Depolarization (Na+ influx) and Repolarization (K+ efflux). Threshold potential must be reached.</li><li><strong>Synapses:</strong> Chemical transmission between neurons. Calcium influx triggers neurotransmitter (e.g., Acetylcholine) release via exocytosis.</li></ul>' },
            { id: 'C3.1', title: 'C3.1: Integration of Body Systems', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Homeostasis:</strong> Maintenance of a constant internal environment within physiological limits.</li><li><strong>Negative Feedback:</strong> Mechanisms that return a variable to its set point (e.g., Thermoregulation, Blood pH, Blood glucose).</li><li><strong>Thermoregulation:</strong> Response to heat (vasodilation, sweating) and cold (vasoconstriction, shivering).</li><li><strong>Blood Glucose:</strong> Controlled by Insulin (beta cells) and Glucagon (alpha cells) from the pancreas. Type I vs Type II diabetes.</li></ul>' },
            { id: 'C3.2', title: 'C3.2: Defense Against Disease', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Pathogens:</strong> Disease-causing organisms (bacteria, viruses, fungi, protozoa).</li><li><strong>First Line:</strong> Skin (barrier, sebum) and Mucous membranes (lysozyme, sticky mucus). Blood clotting (platelets, fibrin).</li><li><strong>Second Line:</strong> Non-specific immunity. Phagocytic white blood cells ingest pathogens. Inflammatory response.</li><li><strong>Third Line:</strong> Specific immunity. Lymphocytes produce specific antibodies. Memory cells provide long-term immunity.</li><li><strong>Antibiotics:</strong> Block bacterial metabolic pathways (e.g., cell wall synthesis). Ineffective against viruses.</li></ul>' },
            { id: 'C4.1', title: 'C4.1: Populations and Communities', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Population Dynamics:</strong> Growth curves (Sigmoid: Exponential, Transitional, Plateau phases). Carrying capacity (K).</li><li><strong>Limiting Factors:</strong> Density-dependent (disease, competition) vs Density-independent (weather, natural disasters).</li><li><strong>Community Interactions:</strong> Herbivory, Predation, Competition (inter/intraspecific), Parasitism, Mutualism.</li><li><strong>Chi-Squared Test:</strong> Statistical test to determine association between two species (presence/absence) using quadrat sampling data.</li></ul>' },
            { id: 'C4.2', title: 'C4.2: Transfers of Energy and Matter', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Energy Flow:</strong> Sunlight is the initial energy source. Energy flows through trophic levels (Producers -> Primary -> Secondary consumers).</li><li><strong>Energy Loss:</strong> Approx 90% energy lost between levels (heat, respiration, uneaten parts). Restricts food chain length.</li><li><strong>Nutrient Cycling:</strong> Nutrients (Carbon, Nitrogen) are recycled. Energy is not. Decomposers (saprotrophs) recycle nutrients.</li><li><strong>Carbon Cycle:</strong> Fluxes (photosynthesis, respiration, combustion) and Pools (atmosphere, biomass, fossil fuels, limestone).</li><li><strong>Climate Change:</strong> Greenhouse gases (CO2, methane) trap heat. Enhanced greenhouse effect leads to global warming.</li></ul>' },
            { id: 'C-NOS', title: 'Nature of Science (NOS) - Theme C', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Experimental Design:</strong> Controlling variables to produce reliable data in enzyme and photosynthesis experiments (C1.1, C1.3).</li><li><strong>Use of Models:</strong> Using simple respirometers to model physiological processes (C1.2).</li><li><strong>Global Collaboration:</strong> The Intergovernmental Panel on Climate Change (IPCC) shares data to model climate change (C4.2).</li><li><strong>Ethical Implications:</strong> Considerations regarding animal testing for medical research and vaccine development (C3.2).</li><li><strong>Paradigm Shifts:</strong> The Chemiosmotic theory (Peter Mitchell) was initially rejected but later accepted to explain ATP synthesis (C1.2/C1.3).</li><li><strong>Public Understanding:</strong> The importance of vaccination programs and herd immunity (C3.2).</li></ul>' },
            { id: 'C-Skills', title: 'Approaches to Learning (Skills) - Theme C', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Calculating Rates:</strong> determining the rate of reaction from graphs or experimental data (C1.1, C1.3).</li><li><strong>Chromatography:</strong> separating photosynthetic pigments and calculating Rf values (C1.3).</li><li><strong>Statistical Analysis:</strong> Using the Chi-squared test to test for association between species (C4.1).</li><li><strong>Constructing Food Webs:</strong> Representing trophic relationships and energy flow (C4.2).</li><li><strong>Graph Interpretation:</strong> Analyzing graphs of enzyme activity and population growth curves (C1.1, C4.1).</li><li><strong>Mesocosms:</strong> Setting up sealed sustainable ecosystems to investigate nutrient cycling (C4.2).</li><li><strong>Oscilloscopes:</strong> Analysis of oscilloscope traces to determine resting and action potentials (C2.2).</li></ul>' }
          ]
        },
        {
          id: 'D', name: 'Theme D', title: 'Continuity and Change', description: 'Theme D examines how living systems maintain continuity (through DNA replication and reproduction) while also allowing for change (through mutation, evolution, and adaptation). It covers the molecular basis of genetics, cell division, inheritance patterns, and the mechanisms of natural selection.', link: 'https://drive.google.com/file/d/1GTZkkyQXSyjHERDSg2-MOAmoTQYDgK8Z/view?usp=drive_link',
          items: [
            { id: 'D1.1', title: 'D1.1: DNA Replication', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Semi-conservative:</strong> Each new DNA molecule consists of one original strand and one newly synthesized strand (Meselson and Stahl).</li><li><strong>Enzymes:</strong> Helicase (unwinds helix), DNA Polymerase III (synthesizes new strand), RNA Primase (adds primer), DNA Ligase (joins Okazaki fragments).</li><li><strong>Directionality:</strong> Replication occurs in the 5\' to 3\' direction. Leading strand (continuous) vs Lagging strand (discontinuous).</li><li><strong>PCR:</strong> Polymerase Chain Reaction amplifies DNA using Taq polymerase and thermal cycling (Denaturation, Annealing, Elongation).</li></ul>' },
            { id: 'D1.2', title: 'D1.2: Protein Synthesis', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Transcription:</strong> Synthesis of mRNA from DNA template by RNA polymerase in the nucleus. Antisense strand is transcribed.</li><li><strong>Translation:</strong> Synthesis of polypeptides on ribosomes. mRNA codons bind to tRNA anticodons carrying specific amino acids.</li><li><strong>Genetic Code:</strong> Universal (same in most organisms) and Degenerate (multiple codons for one amino acid).</li><li><strong>Post-transcriptional Modification:</strong> Splicing (removal of introns) increases protein diversity (HL).</li></ul>' },
            { id: 'D1.3', title: 'D1.3: Mutation and Gene Editing', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Mutations:</strong> Random changes in base sequence. Substitution (e.g., Sickle Cell Anemia), Insertion, Deletion (Frameshift).</li><li><strong>Causes:</strong> Mutagens include radiation (UV, X-rays) and chemical mutagens (carcinogens).</li><li><strong>Gene Editing:</strong> CRISPR-Cas9 system allows precise editing of DNA sequences. Potential for treating genetic diseases.</li></ul>' },
            { id: 'D2.1', title: 'D2.1: Cell and Nuclear Division', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Cell Cycle:</strong> Interphase (G1, S, G2), Mitosis (PMAT), and Cytokinesis. Controlled by Cyclins.</li><li><strong>Mitosis:</strong> Produces two genetically identical diploid daughter cells. Used to growth, repair, asexual reproduction.</li><li><strong>Meiosis:</strong> Produces four genetically distinct haploid gametes. Reduction division (Diploid to Haploid).</li><li><strong>Variation:</strong> Crossing over (Prophase I) and Random Orientation (Metaphase I) increase genetic diversity.</li><li><strong>Nondisjunction:</strong> Failure of chromosomes to separate (e.g., Trisomy 21 / Down Syndrome).</li></ul>' },
            { id: 'D2.2', title: 'D2.2: Gene Expression (HL)', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Regulation:</strong> Gene expression is regulated by proteins (transcription factors) binding to specific DNA sequences (promoters/enhancers).</li><li><strong>Epigenetics:</strong> Chemical modifications (Methylation of DNA, Acetylation of Histones) affect gene accessibility without changing the DNA sequence.</li><li><strong>Environment:</strong> Environmental factors (e.g., pollution, diet) can influence gene expression (e.g., coat color in Himalayan rabbits).</li></ul>' },
            { id: 'D3.1', title: 'D3.1: Reproduction', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Strategies:</strong> Asexual (Binary fission, budding) vs Sexual (fusion of gametes).</li><li><strong>Gametogenesis:</strong> Spermatogenesis (continuous) vs Oogenesis (cyclical/finite).</li><li><strong>Fertilization:</strong> Fusion of sperm and egg to form a zygote. Internal vs External.</li><li><strong>Hormonal Control:</strong> Menstrual cycle regulated by FSH, LH, Estrogen, and Progesterone.</li></ul>' },
            { id: 'D3.2', title: 'D3.2: Inheritance', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Mendel\'s Laws:</strong> Law of Segregation and Law of Independent Assortment.</li><li><strong>Genetics:</strong> Genotype vs Phenotype. Dominant vs Recessive alleles.</li><li><strong>Patterns:</strong> Complete dominance, Codominance (Blood groups), Sex-linkage (Hemophilia, Color blindness).</li><li><strong>Tools:</strong> Punnett grids and Pedigree charts used to predict inheritance probabilities.</li></ul>' },
            { id: 'D4.1', title: 'D4.1: Natural Selection', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Mechanism:</strong> Variation exists -> Overproduction of offspring -> Struggle for existence -> Differential survival/reproduction.</li><li><strong>Variation Sources:</strong> Mutation, Meiosis, Sexual Reproduction.</li><li><strong>Adaptation:</strong> Characteristics that make an individual suited to its environment increase.</li><li><strong>Example:</strong> Antibiotic resistance in bacteria (rapid evolution due to short generation time).</li></ul>' },
            { id: 'D4.2', title: 'D4.2: Stability and Change', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Hardy-Weinberg:</strong> Allele frequencies remain constant in a population unless acted upon by evolutionary forces (HL).</li><li><strong>Stability:</strong> Ecosystems show stability over time but can change due to disturbances (Succession).</li><li><strong>Feedback:</strong> Negative feedback loops maintain stability (Homeostasis); Positive feedback drives change.</li></ul>' },
            { id: 'D-NOS', title: 'Nature of Science (NOS) - Theme D', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Reliability:</strong> The high fidelity of DNA replication ensures genetic continuity, while enzymes proofread to minimize errors (D1.1).</li><li><strong>Serendipity:</strong> The discovery of cyclins was accidental during research on protein synthesis in sea urchins (D2.1).</li><li><strong>Ethical Implications:</strong> The ability to edit genes via CRISPR raises significant ethical questions regarding \'designer babies\' and germline modification (D1.3).</li><li><strong>Paradigm Shifts:</strong> The concept of \'junk DNA\' has shifted as non-coding regions are found to have regulatory functions (D2.2).</li><li><strong>Quantitative Data:</strong> Mendel\'s use of large sample sizes and statistical analysis was crucial in establishing the laws of inheritance (D3.2).</li></ul>' },
            { id: 'D-Skills', title: 'Approaches to Learning (Skills) - Theme D', content: '<ul class="list-disc pl-5 space-y-1"><li><strong>Karyotyping:</strong> Analysis of karyograms to identify chromosomal abnormalities like Down Syndrome (D2.1).</li><li><strong>PCR:</strong> Understanding the practical application of PCR in forensics and medical diagnostics (D1.1).</li><li><strong>Prediction:</strong> Using Punnett grids to predict genotypic and phenotypic ratios of offspring (D3.2).</li><li><strong>Pedigree Analysis:</strong> Deducing patterns of inheritance (autosomal/sex-linked, dominant/recessive) from family trees (D3.2).</li><li><strong>Chi-Squared Test:</strong> Comparing observed vs expected phenotypic ratios to determine if genes are linked (D3.2 HL).</li><li><strong>Microscopy:</strong> Identification of phases of mitosis in root tip squashes (D2.1).</li></ul>' }
          ]
        }
      ];

      const TRACKER_URL = "https://sites.google.com/beaconschool.com.br/ibbiologytracker2025/in%C3%ADcio";
      const KOGNITY_URL = "https://app.kognity.com/study/app/dashboard";

      // ==========================================
      // UTILS
      // ==========================================
      function useLocalStorage(key, initialValue) {
        const readValue = () => {
          if (typeof window === 'undefined') {
            return initialValue;
          }
          try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
          } catch (error) {
            console.warn(`Error reading localStorage key â${key}â:`, error);
            return initialValue;
          }
        };

        const [storedValue, setStoredValue] = useState(readValue);

        const setValue = (value) => {
          try {
            const valueToStore = value instanceof Function ? value(storedValue) : value;
            setStoredValue(valueToStore);
            if (typeof window !== 'undefined') {
              window.localStorage.setItem(key, JSON.stringify(valueToStore));
            }
          } catch (error) {
            console.warn(`Error setting localStorage key â${key}â:`, error);
          }
        };

        useEffect(() => {
          setStoredValue(readValue());
        }, []);

        return [storedValue, setValue];
      }

      // ==========================================
      // COMPONENTS
      // ==========================================

      const Sidebar = ({ isOpen, toggleSidebar }) => {
        const navItems = [
          { name: 'Home', path: PageRoute.HOME, icon: Icons.Home },
          { name: 'IB Biology Tracker', path: PageRoute.TRACKER, icon: Icons.Activity },
          { name: 'E-Coursework Calendar', path: PageRoute.CALENDAR, icon: Icons.Calendar },
          { name: 'Internal Assessment', path: PageRoute.INTERNAL_ASSESSMENT, icon: Icons.FileText },
          { name: 'List of Exercises', path: PageRoute.EXERCISES, icon: Icons.CheckSquare },
          { name: 'Kognity', path: PageRoute.KOGNITY, icon: Icons.BookOpen },
          { name: 'Full Syllabus', path: PageRoute.SYLLABUS, icon: Icons.Layers },
        ];

        return (
          <aside
            className={`
              fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 shadow-lg transform transition-transform duration-300 ease-in-out
              ${isOpen ? 'translate-x-0' : '-translate-x-full'}
              md:relative md:translate-x-0
            `}
          >
            <div className="flex items-center justify-between p-6 border-b border-slate-100">
              <div className="flex items-center space-x-2">
                <div className="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
                  <span className="text-white font-bold text-lg">IB</span>
                </div>
                <span className="text-xl font-bold text-slate-800">Bio Companion</span>
              </div>
              <button onClick={toggleSidebar} className="md:hidden text-slate-500 hover:text-slate-700">
                <Icons.Menu className="w-6 h-6" />
              </button>
            </div>

            <nav className="p-4 space-y-2 overflow-y-auto h-[calc(100vh-80px)]">
              {navItems.map((item) => (
                <NavLink
                  key={item.path}
                  to={item.path}
                  onClick={() => {
                     if (window.innerWidth < 768) toggleSidebar();
                  }}
                  className={({ isActive }) =>
                    `flex items-center space-x-3 px-4 py-3 rounded-xl transition-colors duration-200 ${
                      isActive
                        ? 'bg-primary text-white shadow-md'
                        : 'text-slate-600 hover:bg-slate-50 hover:text-primary'
                    }`
                  }
                >
                  <item.icon className="w-5 h-5" />
                  <span className="font-medium">{item.name}</span>
                </NavLink>
              ))}
            </nav>
          </aside>
        );
      };

      const Header = ({ toggleSidebar, title }) => {
        const deadlines = useMemo(() => {
          const today = new Date();
          today.setHours(0,0,0,0);
          const twoWeeks = new Date();
          twoWeeks.setDate(today.getDate() + 14);

          return CALENDAR_EVENTS.filter(event => {
            if (event.type !== 'deadline') return false;
            
            const [sy, sm, sd] = event.startDate.split('-').map(Number);
            const startDate = new Date(sy, sm - 1, sd);
            
            let endDate = new Date(startDate);
            if (event.endDate) {
              const [ey, em, ed] = event.endDate.split('-').map(Number);
              endDate = new Date(ey, em - 1, ed);
            }
            endDate.setHours(23, 59, 59, 999);

            const isActive = today >= startDate && today <= endDate;
            const isUpcoming = startDate > today && startDate <= twoWeeks;
            
            return isActive || isUpcoming;
          });
        }, []);

        const today = new Date();
        today.setHours(0,0,0,0);

        return (
          <header className="bg-white border-b border-slate-200 sticky top-0 z-40 px-6 py-4 flex items-center justify-between shadow-sm">
            <div className="flex items-center space-x-4">
              <button
                onClick={toggleSidebar}
                className="md:hidden p-2 rounded-lg text-slate-600 hover:bg-slate-100"
              >
                <Icons.Menu className="w-6 h-6" />
              </button>
              <h1 className="text-xl md:text-2xl font-bold text-slate-800">{title}</h1>
            </div>

            <div className="relative group">
              <button className="p-2 rounded-full text-slate-500 hover:bg-slate-100 relative transition-colors">
                <Icons.Bell className="w-6 h-6" />
                {deadlines.length > 0 && (
                  <span className="absolute top-1 right-1 w-4 h-4 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center animate-pulse">
                    {deadlines.length}
                  </span>
                )}
              </button>
              
              <div className="absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-xl border border-slate-100 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right z-50">
                  <div className="p-4 border-b border-slate-100">
                      <h3 className="font-semibold text-slate-800">Deadlines & Tasks</h3>
                  </div>
                  <div className="p-2 max-h-64 overflow-y-auto">
                      {deadlines.length === 0 ? (
                          <p className="text-sm text-slate-500 text-center py-4">No active or upcoming deadlines.</p>
                      ) : (
                          deadlines.map(event => {
                              const [sy, sm, sd] = event.startDate.split('-').map(Number);
                              const startDate = new Date(sy, sm - 1, sd);
                              let endDate = new Date(startDate);
                              if (event.endDate) {
                                const [ey, em, ed] = event.endDate.split('-').map(Number);
                                endDate = new Date(ey, em - 1, ed);
                              }
                              endDate.setHours(23, 59, 59, 999);
                              const isActive = today >= startDate && today <= endDate;

                              return (
                                <div key={event.id} className="p-3 hover:bg-slate-50 rounded-lg">
                                    <div className="flex items-center justify-between gap-2">
                                        <p className="text-sm font-medium text-slate-800">{event.title}</p>
                                        {isActive && (
                                            <span className="flex-shrink-0 text-[10px] font-bold bg-red-100 text-red-600 px-1.5 py-0.5 rounded uppercase">Active Now</span>
                                        )}
                                    </div>
                                    <p className="text-xs text-red-500 mt-1">
                                        {isActive ? `Ends: ${event.endDate || event.startDate}` : `Starts: ${event.startDate}`}
                                    </p>
                                </div>
                              );
                          })
                      )}
                  </div>
              </div>
            </div>
          </header>
        );
      };

      // ==========================================
      // PAGES
      // ==========================================

      const Home = () => {
        return (
          <div className="max-w-4xl mx-auto space-y-8">
            <div className="bg-gradient-to-r from-primary to-teal-800 text-white rounded-2xl p-8 shadow-lg">
              <h2 className="text-3xl font-bold mb-4">Welcome to IB Biology</h2>
              <p className="text-teal-100 text-lg leading-relaxed">
                Your comprehensive companion for the Biology Guide (2025). This platform is designed to help you track your progress, manage deadlines, and access vital resources for your success in the International Baccalaureate program.
              </p>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                <h3 className="text-xl font-bold text-slate-800 mb-3">Course Description</h3>
                <p className="text-slate-600 leading-relaxed">
                  Biologists have accumulated a huge amount of information about living organisms, and it would be easy to confuse students by teaching large numbers of seemingly unrelated facts. In the IB Biology course, it is hoped that students will acquire a limited body of facts and, at the same time, develop a broad, general understanding of the principles of the subject.
                </p>
              </div>

              <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md transition-shadow">
                <h3 className="text-xl font-bold text-slate-800 mb-3">Key Objectives</h3>
                <ul className="space-y-2 text-slate-600">
                  <li className="flex items-start">
                    <span className="mr-2 text-primary">â¢</span>
                    <span>Demonstrate knowledge and understanding of facts, concepts, and terminology.</span>
                  </li>
                  <li className="flex items-start">
                    <span className="mr-2 text-primary">â¢</span>
                    <span>Apply methodologies and techniques.</span>
                  </li>
                  <li className="flex items-start">
                    <span className="mr-2 text-primary">â¢</span>
                    <span>Formulate, analyze and evaluate hypotheses, research questions and predictions.</span>
                  </li>
                </ul>
              </div>
            </div>

            <div className="bg-amber-50 border-l-4 border-accent p-6 rounded-r-xl">
              <h3 className="text-lg font-bold text-accent mb-2">Important Note</h3>
              <p className="text-slate-700">
                  Please regularly check the <strong>E-Coursework Calendar</strong> for upcoming internal assessment deadlines. Notifications will appear in the top right corner of this screen.
              </p>
            </div>
          </div>
        );
      };

      const Tracker = () => {
        return (
          <div className="h-full flex flex-col items-center justify-center p-8 space-y-8 text-center bg-white rounded-xl shadow-sm border border-slate-200 min-h-[500px]">
              <div className="w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center">
                  <Icons.Activity className="w-12 h-12 text-blue-600" />
              </div>
              <div className="max-w-md">
                  <h2 className="text-3xl font-bold text-slate-800 mb-4">IB Biology Tracker</h2>
                  <p className="text-slate-600 mb-8">
                      Access the official IB Biology Tracker website to view your class progress, updates, and specific tracking materials.
                  </p>
                  <a 
                      href={TRACKER_URL} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      className="inline-flex items-center justify-center px-8 py-4 bg-primary text-white text-lg font-bold rounded-xl hover:bg-teal-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                      Open Tracker
                      <Icons.ExternalLink className="w-5 h-5 ml-2" />
                  </a>
              </div>
              <p className="text-sm text-slate-400">
                  Note: The tracker will open in a new tab to ensure secure access.
              </p>
          </div>
        );
      };

      const CalendarView = () => {
        const [currentDate, setCurrentDate] = useState(new Date());

        const year = currentDate.getFullYear();
        const month = currentDate.getMonth();

        const monthNames = ["January", "February", "March", "April", "May", "June",
          "July", "August", "September", "October", "November", "December"
        ];

        const prevMonth = () => setCurrentDate(new Date(year, month - 1, 1));
        const nextMonth = () => setCurrentDate(new Date(year, month + 1, 1));
        const goToToday = () => setCurrentDate(new Date());

        const parseLocalDate = (dateStr) => {
          const [y, m, d] = dateStr.split('-').map(Number);
          return new Date(y, m - 1, d);
        };
        
        const formatLocalDate = (date) => {
          const y = date.getFullYear();
          const m = String(date.getMonth() + 1).padStart(2, '0');
          const d = String(date.getDate()).padStart(2, '0');
          return `${y}-${m}-${d}`;
        };

        const calendarDays = useMemo(() => {
          const firstDayOfMonth = new Date(year, month, 1);
          const lastDayOfMonth = new Date(year, month + 1, 0);
          
          const startDate = new Date(firstDayOfMonth);
          startDate.setDate(firstDayOfMonth.getDate() - firstDayOfMonth.getDay());

          const endDate = new Date(lastDayOfMonth);
          if (endDate.getDay() !== 6) {
              endDate.setDate(endDate.getDate() + (6 - endDate.getDay()));
          }

          const days = [];
          const loopDate = new Date(startDate);
          while (loopDate <= endDate) {
              days.push(new Date(loopDate));
              loopDate.setDate(loopDate.getDate() + 1);
          }
          return days;
        }, [year, month]);

        const weeks = useMemo(() => {
          const chunks = [];
          for (let i = 0; i < calendarDays.length; i += 7) {
              chunks.push(calendarDays.slice(i, i + 7));
          }
          return chunks;
        }, [calendarDays]);

        const getEventsForWeek = (weekStart, weekEnd) => {
          const weekStartStr = formatLocalDate(weekStart);
          const weekEndStr = formatLocalDate(weekEnd);

          return CALENDAR_EVENTS.filter(e => {
              const start = e.startDate;
              const end = e.endDate || e.startDate;
              return (start <= weekEndStr) && (end >= weekStartStr);
          }).sort((a, b) => {
              return a.startDate.localeCompare(b.startDate);
          });
        };

        const isSameDate = (d1, d2) => {
            return d1.getFullYear() === d2.getFullYear() &&
                  d1.getMonth() === d2.getMonth() &&
                  d1.getDate() === d2.getDate();
        };

        return (
          <div className="space-y-6 h-full flex flex-col">
            <div className="bg-white rounded-xl shadow-sm border border-slate-200 flex-grow flex flex-col">
              {/* Header */}
              <div className="flex items-center justify-between p-6 border-b border-slate-200">
                  <h2 className="text-2xl font-bold text-slate-800 flex items-center gap-2">
                      {monthNames[month]} <span className="text-slate-400 font-normal">{year}</span>
                  </h2>
                  <div className="flex space-x-2">
                      <button onClick={goToToday} className="px-3 py-2 text-sm font-medium text-slate-600 bg-slate-100 rounded hover:bg-slate-200 transition-colors">
                          Today
                      </button>
                      <div className="w-px h-8 bg-slate-200 mx-2"></div>
                      <button onClick={prevMonth} className="p-2 rounded hover:bg-slate-100 border border-slate-200 transition-colors">
                          <Icons.ChevronLeft className="w-5 h-5 text-slate-600" />
                      </button>
                      <button onClick={nextMonth} className="p-2 rounded hover:bg-slate-100 border border-slate-200 transition-colors">
                          <Icons.ChevronRight className="w-5 h-5 text-slate-600" />
                      </button>
                  </div>
              </div>

              {/* Days Header */}
              <div className="grid grid-cols-7 border-b border-slate-200 bg-slate-50">
                  {['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].map(day => (
                      <div key={day} className="py-2 text-center text-sm font-bold text-slate-500 uppercase tracking-wide">
                          {day}
                      </div>
                  ))}
              </div>

              {/* Calendar Grid */}
              <div className="flex-grow flex flex-col overflow-y-auto">
                  {weeks.map((week, wIndex) => {
                      const weekStart = week[0];
                      const weekEnd = week[6];
                      const weekEvents = getEventsForWeek(weekStart, weekEnd);

                      return (
                          <div key={wIndex} className="relative min-h-[140px] flex-1 border-b border-slate-200 last:border-b-0">
                              {/* 1. Background Grid (Dates) */}
                              <div className="absolute inset-0 grid grid-cols-7 divide-x divide-slate-100">
                                  {week.map((day, dIndex) => {
                                      const isCurrentMonth = day.getMonth() === month;
                                      const isToday = isSameDate(day, new Date());
                                      
                                      return (
                                          <div key={dIndex} className={`p-2 relative ${isCurrentMonth ? 'bg-white' : 'bg-slate-50/50'}`}>
                                              <span 
                                                  className={`
                                                      flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold
                                                      ${isToday ? 'bg-primary text-white shadow-md' : isCurrentMonth ? 'text-slate-700' : 'text-slate-400'}
                                                  `}
                                              >
                                                  {day.getDate()}
                                              </span>
                                          </div>
                                      );
                                  })}
                              </div>

                              {/* 2. Events Layer (Overlay) */}
                              <div className="relative z-10 grid grid-cols-7 gap-y-1 pt-12 pb-2 px-1 pointer-events-none">
                                  {weekEvents.map(event => {
                                      const eventStart = parseLocalDate(event.startDate);
                                      const eventEnd = event.endDate ? parseLocalDate(event.endDate) : parseLocalDate(event.startDate);
                                      
                                      let startIndex = 0;
                                      if (eventStart >= weekStart) {
                                          startIndex = eventStart.getDay();
                                      }
                                      
                                      let endIndex = 6;
                                      if (eventEnd <= weekEnd) {
                                          endIndex = eventEnd.getDay();
                                      }

                                      const colStart = startIndex + 1;
                                      const colSpan = endIndex - startIndex + 1;

                                      let styles = "bg-blue-100 text-blue-800 border-blue-200"; 
                                      if (event.type === 'deadline') {
                                          styles = "bg-red-600 text-white border-red-700 shadow-md"; 
                                      } else if (event.type === 'exam') {
                                          styles = "bg-amber-100 text-amber-900 border-amber-300";
                                      }

                                      return (
                                          <div
                                              key={`${event.id}-${wIndex}`}
                                              className={`
                                                  ${styles} border rounded px-2 py-1 text-xs md:text-sm font-medium truncate pointer-events-auto
                                                  hover:opacity-90 transition-opacity cursor-pointer relative
                                              `}
                                              style={{
                                                  gridColumnStart: colStart,
                                                  gridColumnEnd: `span ${colSpan}`,
                                              }}
                                              title={`${event.title}${event.description ? '\n\n' + event.description : ''}\n\nDates: ${event.startDate}${event.endDate ? ' - ' + event.endDate : ''}`}
                                          >
                                              {event.title}
                                          </div>
                                      );
                                  })}
                              </div>
                          </div>
                      );
                  })}
              </div>
            </div>

            <div className="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex flex-wrap gap-6 items-center">
              <h3 className="text-lg font-bold text-slate-800 mr-4">Legend:</h3>
              <div className="flex items-center space-x-2">
                  <div className="w-6 h-6 bg-red-600 rounded border border-red-700 shadow-sm"></div>
                  <span className="text-sm font-medium text-slate-700">Deadline (Critical)</span>
              </div>
              <div className="flex items-center space-x-2">
                  <div className="w-6 h-6 bg-amber-100 rounded border border-amber-300"></div>
                  <span className="text-sm font-medium text-slate-700">Exam</span>
              </div>
              <div className="flex items-center space-x-2">
                  <div className="w-6 h-6 bg-blue-100 rounded border border-blue-200"></div>
                  <span className="text-sm font-medium text-slate-700">Reminder/Step</span>
              </div>
            </div>
          </div>
        );
      };

      const InternalAssessment = () => {
        return (
          <div className="space-y-6">
            <div className="bg-white p-8 rounded-xl shadow-sm border border-slate-200">
              <h2 className="text-2xl font-bold text-slate-800 mb-2">Internal Assessment Resources</h2>
              <p className="text-slate-600">
                  Access guidelines, criteria, and samples to help you structure your Internal Assessment effectively.
                  Always refer to the latest APA guidelines for your citations.
              </p>
            </div>

            <div className="grid md:grid-cols-2 gap-6">
              {IA_RESOURCES.map((resource, index) => (
                  <a 
                      key={index}
                      href={resource.link}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="block group"
                  >
                      <div className="bg-white p-6 rounded-xl shadow-sm border border-slate-200 hover:shadow-md hover:border-primary transition-all duration-200 h-full flex flex-col">
                          <div className="flex items-start justify-between mb-4">
                              <div className={`p-3 rounded-lg ${resource.type === 'folder' ? 'bg-amber-50 text-amber-600' : 'bg-blue-50 text-blue-600'}`}>
                                  {resource.type === 'folder' ? <Icons.Folder className="w-6 h-6" /> : <Icons.FileText className="w-6 h-6" />}
                              </div>
                              <Icons.Download className="w-5 h-5 text-slate-400 group-hover:text-primary" />
                          </div>
                          <h3 className="text-lg font-bold text-slate-800 mb-2 group-hover:text-primary transition-colors">{resource.title}</h3>
                          <p className="text-slate-600 text-sm flex-grow">{resource.description}</p>
                      </div>
                  </a>
              ))}
            </div>
          </div>
        );
      };

      const Exercises = () => {
        const [exerciseLogs, setExerciseLogs] = useLocalStorage('ib-bio-exercises-log', {});

        const toggleComplete = (id, date) => {
          setExerciseLogs(prev => {
              const current = prev[id] || { completed: false, dateCompleted: '' };
              if (date) {
                  return { ...prev, [id]: { ...current, dateCompleted: date, completed: true } };
              } else {
                  const newCompleted = !current.completed;
                  return { 
                      ...prev, 
                      [id]: { 
                          completed: newCompleted, 
                          dateCompleted: newCompleted ? (current.dateCompleted || new Date().toISOString().split('T')[0]) : null 
                      } 
                  };
              }
          });
        };

        const FileTextIconComponent = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
        );

        return (
          <div className="space-y-6">
            <div className="bg-white p-8 rounded-xl shadow-sm border border-slate-200">
              <h2 className="text-2xl font-bold text-slate-800 mb-2">List of Exercises</h2>
              <p className="text-slate-600">
                  Track your progress through the exercise lists. Download the markscheme only after attempting the problems.
                  Your progress is saved automatically in this browser.
              </p>
            </div>

            <div className="space-y-4">
              {EXERCISES.map((exercise) => {
                  const log = exerciseLogs[exercise.id] || { completed: false, dateCompleted: '' };
                  
                  return (
                      <div key={exercise.id} className={`bg-white rounded-xl shadow-sm border p-6 transition-all ${log.completed ? 'border-green-200 bg-green-50/30' : 'border-slate-200'}`}>
                          <div className="flex flex-col md:flex-row md:items-center justify-between gap-4">
                              <div className="flex items-start space-x-4 flex-grow">
                                  <button 
                                      onClick={() => toggleComplete(exercise.id)}
                                      className={`mt-1 flex-shrink-0 w-6 h-6 rounded border flex items-center justify-center transition-colors ${log.completed ? 'bg-green-500 border-green-500 text-white' : 'bg-white border-slate-300 text-transparent hover:border-green-500'}`}
                                  >
                                      <Icons.Check className="w-4 h-4" />
                                  </button>
                                  <div>
                                      <h3 className={`font-bold text-lg ${log.completed ? 'text-green-800' : 'text-slate-800'}`}>{exercise.title}</h3>
                                      <div className="flex flex-wrap gap-4 mt-2 text-sm">
                                          <a href={exercise.pdfLink} target="_blank" rel="noopener noreferrer" className="flex items-center text-primary hover:underline">
                                              <Icons.FileText className="w-4 h-4 mr-1"/> Open Exercise PDF
                                          </a>
                                          <a href={exercise.markschemeLink} target="_blank" rel="noopener noreferrer" className="flex items-center text-slate-500 hover:text-slate-800">
                                              <Icons.Download className="w-4 h-4 mr-1"/> Download Markscheme
                                          </a>
                                      </div>
                                  </div>
                              </div>

                              <div className="flex items-center space-x-2 bg-slate-50 p-2 rounded-lg border border-slate-200">
                                  <Icons.Calendar className="w-4 h-4 text-slate-400" />
                                  <span className="text-xs text-slate-500 font-medium uppercase tracking-wide">Completed:</span>
                                  <input 
                                      type="date" 
                                      value={log.dateCompleted || ''}
                                      onChange={(e) => toggleComplete(exercise.id, e.target.value)}
                                      className="bg-transparent border-none text-sm text-slate-700 focus:ring-0 cursor-pointer"
                                  />
                              </div>

                          </div>
                      </div>
                  );
              })}
            </div>
          </div>
        );
      };

      const Kognity = () => {
        return (
          <div className="h-full flex flex-col items-center justify-center p-8 space-y-8 text-center bg-white rounded-xl shadow-sm border border-slate-200 min-h-[500px]">
              <div className="w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center">
                  <Icons.BookOpen className="w-12 h-12 text-blue-600" />
              </div>
              <div className="max-w-md">
                  <h2 className="text-3xl font-bold text-slate-800 mb-4">Kognity Digital Textbook</h2>
                  <p className="text-slate-600 mb-8">
                      Access your interactive textbook, assignments, and study materials directly through Kognity's platform.
                  </p>
                  <a 
                      href={KOGNITY_URL} 
                      target="_blank" 
                      rel="noopener noreferrer"
                      className="inline-flex items-center justify-center px-8 py-4 bg-primary text-white text-lg font-bold rounded-xl hover:bg-teal-700 transition-colors shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                  >
                      Launch Kognity
                      <Icons.ExternalLink className="w-5 h-5 ml-2" />
                  </a>
              </div>
              <p className="text-sm text-slate-400">
                  Note: Kognity will open in a new tab to ensure secure access.
              </p>
          </div>
        );
      };

      const Syllabus = () => {
        const [expandedThemes, setExpandedThemes] = useState(['A']);

        const toggleTheme = (id) => {
          setExpandedThemes(prev => 
            prev.includes(id) ? prev.filter(t => t !== id) : [...prev, id]
          );
        };

        return (
          <div className="space-y-6">
            <div className="bg-white p-8 rounded-xl shadow-sm border border-slate-200">
              <h2 className="text-2xl font-bold text-slate-800 mb-2">Full Syllabus Guide</h2>
              <p className="text-slate-600">
                  Detailed breakdown of Themes A, B, C, and D. Click on a theme to view specific topics and descriptions.
              </p>
            </div>

            <div className="space-y-4">
              {SYLLABUS_DATA.map((theme) => {
                  const isExpanded = expandedThemes.includes(theme.id);
                  
                  return (
                      <div key={theme.id} className="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                          <button 
                              onClick={() => toggleTheme(theme.id)}
                              className="w-full flex items-center justify-between p-6 bg-slate-50 hover:bg-slate-100 transition-colors text-left"
                          >
                              <div className="flex items-center space-x-4">
                                  <div className="w-10 h-10 rounded-lg bg-primary text-white flex items-center justify-center font-bold text-lg">
                                      {theme.id}
                                  </div>
                                  <div>
                                      <h3 className="text-lg font-bold text-slate-800">{theme.title}</h3>
                                      <p className="text-sm text-slate-500">{theme.name}</p>
                                  </div>
                              </div>
                              {isExpanded ? <Icons.ChevronDown className="text-slate-400" /> : <Icons.ChevronRight className="text-slate-400" />}
                          </button>
                          
                          {isExpanded && (
                              <div className="p-6 border-t border-slate-100">
                                  <p className="text-slate-600 mb-6 italic">{theme.description}</p>
                                  
                                  <a 
                                      href={theme.link}
                                      target="_blank" 
                                      rel="noopener noreferrer"
                                      className="inline-flex items-center text-sm font-medium text-primary hover:underline mb-6"
                                  >
                                      <Icons.FileText className="w-4 h-4 mr-1" /> View Official Theme PDF
                                  </a>

                                  <div className="space-y-4 pl-4 border-l-2 border-slate-200 ml-4">
                                      {theme.items.map(item => (
                                          <div key={item.id} className="relative">
                                              <div className="absolute -left-[21px] top-1 w-3 h-3 rounded-full bg-slate-300 border-2 border-white"></div>
                                              <h4 className="font-bold text-slate-800">{item.title}</h4>
                                              <div className="mt-1 text-slate-600 text-sm leading-relaxed" dangerouslySetInnerHTML={{ __html: item.content }} />
                                          </div>
                                      ))}
                                  </div>
                              </div>
                          )}
                      </div>
                  );
              })}
            </div>
          </div>
        );
      };

      // ==========================================
      // MAIN APP
      // ==========================================

      const AppContent = () => {
        const [sidebarOpen, setSidebarOpen] = useState(false);
        const location = useLocation();

        const getPageTitle = (path) => {
          switch(path) {
              case PageRoute.HOME: return 'Home';
              case PageRoute.TRACKER: return 'IB Biology Tracker';
              case PageRoute.CALENDAR: return 'E-Coursework Calendar';
              case PageRoute.INTERNAL_ASSESSMENT: return 'Internal Assessment';
              case PageRoute.EXERCISES: return 'List of Exercises';
              case PageRoute.KOGNITY: return 'Kognity';
              case PageRoute.SYLLABUS: return 'Full Syllabus';
              default: return 'IB Bio Companion';
          }
        };

        return (
          <div className="flex h-screen bg-slate-50 overflow-hidden font-sans">
            <Sidebar isOpen={sidebarOpen} toggleSidebar={() => setSidebarOpen(!sidebarOpen)} />
            
            <div className="flex-1 flex flex-col h-full w-full relative">
              <Header 
                  toggleSidebar={() => setSidebarOpen(!sidebarOpen)} 
                  title={getPageTitle(location.pathname)}
              />
              
              <main className="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth">
                <div className="max-w-7xl mx-auto h-full">
                  <Routes>
                      <Route path={PageRoute.HOME} element={<Home />} />
                      <Route path={PageRoute.TRACKER} element={<Tracker />} />
                      <Route path={PageRoute.CALENDAR} element={<CalendarView />} />
                      <Route path={PageRoute.INTERNAL_ASSESSMENT} element={<InternalAssessment />} />
                      <Route path={PageRoute.EXERCISES} element={<Exercises />} />
                      <Route path={PageRoute.KOGNITY} element={<Kognity />} />
                      <Route path={PageRoute.SYLLABUS} element={<Syllabus />} />
                      <Route path="*" element={<Navigate to={PageRoute.HOME} replace />} />
                  </Routes>
                </div>
              </main>
            </div>

            {sidebarOpen && (
              <div 
                className="fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden"
                onClick={() => setSidebarOpen(false)}
              ></div>
            )}
          </div>
        );
      };

      const App = () => {
        return (
          <HashRouter>
            <AppContent />
          </HashRouter>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>